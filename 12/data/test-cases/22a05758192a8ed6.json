{"uid":"22a05758192a8ed6","name":"test_calculate_top_topics_with_large_limit","fullName":"tests.database.test_database_analysis_results.TestCalculateTopTopicsStatistics#test_calculate_top_topics_with_large_limit","historyId":"47499abdce97be80f67942e6a2f39579","time":{"start":1763829101617,"stop":1763829101617,"duration":0},"description":"Test calculating top topics with a large limit, and verify that all available topics are returned without error.","descriptionHtml":"<p>Test calculating top topics with a large limit, and verify that all available topics are returned without error.</p>\n","status":"failed","statusMessage":"AssertionError: assert 3 == 4\n +  where 3 = len([{'count': 1, 'topic': 'A'}, {'count': 1, 'topic': 'B'}, {'count': 1, 'topic': 'D'}])","statusTrace":"self = <test_database_analysis_results.TestCalculateTopTopicsStatistics object at 0x7f61ed0ca300>\nmock_db = Database(mongomock.MongoClient('localhost', 27017), 'reddit')\n\n    @allure.sub_suite(\"Calculate top topics with large limit\")\n    @allure.description(\"Test calculating top topics with a large limit, and verify that all available topics are returned without error.\")\n    def test_calculate_top_topics_with_large_limit(self, mock_db):\n        db = mock_db\n    \n        current_date = datetime.now(timezone.utc)\n        test_data = [\n            { \"subreddit\": \"example\", \"topic\": [\"A\", \"B\", \"C\"], \"timestamp\": current_date },\n            { \"subreddit\": \"example\", \"topic\": [\"A\", \"B\", \"D\"], \"timestamp\": (current_date - timedelta(days=1)) },\n        ]\n    \n        # Tested function uses hardcoded collection name \"posts\"\n        db[\"posts\"].insert_many(test_data)\n    \n        large_limit = 50\n        topic_stats = get_top_topics_by_timeperiod(subreddit=\"example\", number_of_days=2, limit=large_limit)\n    \n        assert isinstance(topic_stats, list)\n        results = topic_stats[0]\n    \n        # Expecting all unique topics (A, B, C, D) to be returned (today's data included)\n>       assert len(results[\"topics\"]) == 4\nE       AssertionError: assert 3 == 4\nE        +  where 3 = len([{'count': 1, 'topic': 'A'}, {'count': 1, 'topic': 'B'}, {'count': 1, 'topic': 'D'}])\n\ntests/database/test_database_analysis_results.py:249: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"monkeypatch","time":{"start":1763829101616,"stop":1763829101616,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"mock_db","time":{"start":1763829101616,"stop":1763829101616,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[{"name":"monkeypatch::0","time":{"start":1763829101623,"stop":1763829101623,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"mock_db::0","time":{"start":1763829101623,"stop":1763829101623,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"suite","value":"TC-07: Calculate top topics statistics from analysis results"},{"name":"severity","value":"normal"},{"name":"parentSuite","value":"Database tests"},{"name":"subSuite","value":"Calculate top topics with large limit"},{"name":"host","value":"runnervmg1sw1"},{"name":"thread","value":"2526-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.database.test_database_analysis_results"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":4,"broken":0,"skipped":0,"passed":0,"unknown":0,"total":4},"items":[{"uid":"88e3744ab673b9bf","reportUrl":"https://ohjelmistoprojekti-ii-reddit-app.github.io/reddit-app-backend/11/#testresult/88e3744ab673b9bf","status":"failed","statusDetails":"AssertionError: assert 3 == 4\n +  where 3 = len([{'count': 1, 'topic': 'A'}, {'count': 1, 'topic': 'B'}, {'count': 1, 'topic': 'D'}])","time":{"start":1763828620955,"stop":1763828620956,"duration":1}},{"uid":"3927375b4dbd761","reportUrl":"https://ohjelmistoprojekti-ii-reddit-app.github.io/reddit-app-backend/10/#testresult/3927375b4dbd761","status":"failed","statusDetails":"AssertionError: assert 3 == 4\n +  where 3 = len([{'count': 1, 'topic': 'A'}, {'count': 1, 'topic': 'B'}, {'count': 1, 'topic': 'D'}])","time":{"start":1763824513911,"stop":1763824513911,"duration":0}},{"uid":"f737b5803e93a551","reportUrl":"https://ohjelmistoprojekti-ii-reddit-app.github.io/reddit-app-backend/9/#testresult/f737b5803e93a551","status":"failed","statusDetails":"AssertionError: assert 3 == 4\n +  where 3 = len([{'count': 1, 'topic': 'A'}, {'count': 1, 'topic': 'B'}, {'count': 1, 'topic': 'D'}])","time":{"start":1763821889987,"stop":1763821889988,"duration":1}}]},"tags":[]},"source":"22a05758192a8ed6.json","parameterValues":[]}