{"uid":"bf044cfa2981cb0a","name":"test_update_nonexisting_document","fullName":"tests.database.test_database_crud.TestUpdateDataInDatabase#test_update_nonexisting_document","historyId":"dd1772370e3cc2e708a28045fd47e1cb","time":{"start":1763992053016,"stop":1763992053016,"duration":0},"description":"Test updating non-existing document, and verify that a ValueError was raised.","descriptionHtml":"<p>Test updating non-existing document, and verify that a ValueError was raised.</p>\n","status":"broken","statusMessage":"ConnectionError: Database error: Update failed: no matching documents found","statusTrace":"collection = 'test_collection', filter = {'title': 'Nonexistent'}\nupdate = {'$set': {'content': 'Updated content'}}\n\n    def update_one_item_in_collection(collection, filter, update):\n        if not isinstance(filter, dict):\n            raise TypeError(\"Parameter 'filter' must be a dictionary\")\n        if not isinstance(update, dict):\n            raise TypeError(\"Parameter 'update' must be a dictionary\")\n    \n        print(\"Updating data in database..\")\n        client, db = connect_db()\n        try:\n            coll = db[collection]\n            result = coll.update_one(filter, update)\n            if result.matched_count == 0:\n>               raise ValueError(\"Update failed: no matching documents found\")\nE               ValueError: Update failed: no matching documents found\n\napp/services/db.py:80: ValueError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <test_database_crud.TestUpdateDataInDatabase object at 0x7f3612e579b0>\nmock_db = Database(mongomock.MongoClient('localhost', 27017), 'reddit')\n\n    @allure.sub_suite(\"Update non-existent document\")\n    @allure.description(\"Test updating non-existing document, and verify that a ValueError was raised.\")\n    def test_update_nonexisting_document(self, mock_db):\n        db = mock_db\n    \n        test_data = { \"title\": \"Test Post\", \"content\": \"This is a test post\" }\n        collection = \"test_collection\"\n        db[collection].insert_one(test_data)\n    \n        with pytest.raises(ValueError):\n>           update_one_item_in_collection(collection, {\"title\": \"Nonexistent\"}, {\"$set\": {\"content\": \"Updated content\"}})\n\ntests/database/test_database_crud.py:173: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncollection = 'test_collection', filter = {'title': 'Nonexistent'}\nupdate = {'$set': {'content': 'Updated content'}}\n\n    def update_one_item_in_collection(collection, filter, update):\n        if not isinstance(filter, dict):\n            raise TypeError(\"Parameter 'filter' must be a dictionary\")\n        if not isinstance(update, dict):\n            raise TypeError(\"Parameter 'update' must be a dictionary\")\n    \n        print(\"Updating data in database..\")\n        client, db = connect_db()\n        try:\n            coll = db[collection]\n            result = coll.update_one(filter, update)\n            if result.matched_count == 0:\n                raise ValueError(\"Update failed: no matching documents found\")\n        except Exception as e:\n>           raise ConnectionError(f\"Database error: {e}\")\nE           ConnectionError: Database error: Update failed: no matching documents found\n\napp/services/db.py:82: ConnectionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"mock_db","time":{"start":1763992053015,"stop":1763992053015,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"monkeypatch","time":{"start":1763992053015,"stop":1763992053015,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Test updating non-existing document, and verify that a ValueError was raised.","status":"broken","statusMessage":"ConnectionError: Database error: Update failed: no matching documents found","statusTrace":"collection = 'test_collection', filter = {'title': 'Nonexistent'}\nupdate = {'$set': {'content': 'Updated content'}}\n\n    def update_one_item_in_collection(collection, filter, update):\n        if not isinstance(filter, dict):\n            raise TypeError(\"Parameter 'filter' must be a dictionary\")\n        if not isinstance(update, dict):\n            raise TypeError(\"Parameter 'update' must be a dictionary\")\n    \n        print(\"Updating data in database..\")\n        client, db = connect_db()\n        try:\n            coll = db[collection]\n            result = coll.update_one(filter, update)\n            if result.matched_count == 0:\n>               raise ValueError(\"Update failed: no matching documents found\")\nE               ValueError: Update failed: no matching documents found\n\napp/services/db.py:80: ValueError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <test_database_crud.TestUpdateDataInDatabase object at 0x7f3612e579b0>\nmock_db = Database(mongomock.MongoClient('localhost', 27017), 'reddit')\n\n    @allure.sub_suite(\"Update non-existent document\")\n    @allure.description(\"Test updating non-existing document, and verify that a ValueError was raised.\")\n    def test_update_nonexisting_document(self, mock_db):\n        db = mock_db\n    \n        test_data = { \"title\": \"Test Post\", \"content\": \"This is a test post\" }\n        collection = \"test_collection\"\n        db[collection].insert_one(test_data)\n    \n        with pytest.raises(ValueError):\n>           update_one_item_in_collection(collection, {\"title\": \"Nonexistent\"}, {\"$set\": {\"content\": \"Updated content\"}})\n\ntests/database/test_database_crud.py:173: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncollection = 'test_collection', filter = {'title': 'Nonexistent'}\nupdate = {'$set': {'content': 'Updated content'}}\n\n    def update_one_item_in_collection(collection, filter, update):\n        if not isinstance(filter, dict):\n            raise TypeError(\"Parameter 'filter' must be a dictionary\")\n        if not isinstance(update, dict):\n            raise TypeError(\"Parameter 'update' must be a dictionary\")\n    \n        print(\"Updating data in database..\")\n        client, db = connect_db()\n        try:\n            coll = db[collection]\n            result = coll.update_one(filter, update)\n            if result.matched_count == 0:\n                raise ValueError(\"Update failed: no matching documents found\")\n        except Exception as e:\n>           raise ConnectionError(f\"Database error: {e}\")\nE           ConnectionError: Database error: Update failed: no matching documents found\n\napp/services/db.py:82: ConnectionError","steps":[],"attachments":[{"uid":"42d1c3a325a048fd","name":"stdout","source":"42d1c3a325a048fd.txt","type":"text/plain","size":28}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"mock_db::0","time":{"start":1763992053025,"stop":1763992053025,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"monkeypatch::0","time":{"start":1763992053025,"stop":1763992053025,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"subSuite","value":"Update non-existent document"},{"name":"parentSuite","value":"Database tests"},{"name":"severity","value":"critical"},{"name":"suite","value":"TC-03: Update data in database"},{"name":"host","value":"runnervmg1sw1"},{"name":"thread","value":"2570-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.database.test_database_crud"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"critical","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":6,"skipped":0,"passed":0,"unknown":0,"total":6},"items":[{"uid":"d4cf8fa8ee958342","reportUrl":"https://ohjelmistoprojekti-ii-reddit-app.github.io/reddit-app-backend/13/#testresult/d4cf8fa8ee958342","status":"broken","statusDetails":"ConnectionError: Database error: Update failed: no matching documents found","time":{"start":1763990240071,"stop":1763990240071,"duration":0}},{"uid":"da3550e29a05066b","reportUrl":"https://ohjelmistoprojekti-ii-reddit-app.github.io/reddit-app-backend/12/#testresult/da3550e29a05066b","status":"broken","statusDetails":"ConnectionError: Database error: Update failed: no matching documents found","time":{"start":1763829101700,"stop":1763829101700,"duration":0}},{"uid":"d65c31b7f1640754","reportUrl":"https://ohjelmistoprojekti-ii-reddit-app.github.io/reddit-app-backend/11/#testresult/d65c31b7f1640754","status":"broken","statusDetails":"ConnectionError: Database error: Update failed: no matching documents found","time":{"start":1763828621043,"stop":1763828621043,"duration":0}},{"uid":"d4658b74693b7abf","reportUrl":"https://ohjelmistoprojekti-ii-reddit-app.github.io/reddit-app-backend/10/#testresult/d4658b74693b7abf","status":"broken","statusDetails":"ConnectionError: Database error: Update failed: no matching documents found","time":{"start":1763824513997,"stop":1763824513997,"duration":0}},{"uid":"32134306f7509063","reportUrl":"https://ohjelmistoprojekti-ii-reddit-app.github.io/reddit-app-backend/9/#testresult/32134306f7509063","status":"broken","statusDetails":"ConnectionError: Database error: Update failed: no matching documents found","time":{"start":1763821890070,"stop":1763821890070,"duration":0}}]},"tags":[]},"source":"bf044cfa2981cb0a.json","parameterValues":[]}