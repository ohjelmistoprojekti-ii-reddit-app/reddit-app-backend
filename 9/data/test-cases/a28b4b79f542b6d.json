{"uid":"a28b4b79f542b6d","name":"test_fetch_latest_results_with_type_filter","fullName":"tests.database.test_database_analysis_results.TestFetchLatestAnalysisResultsFromDatabase#test_fetch_latest_results_with_type_filter","historyId":"5b7abd72b59f120a549bed54cd1142fb","time":{"start":1763821889892,"stop":1763821889893,"duration":1},"description":"Test fetching latest data with type filter from the database, and verify that correct documents (with most recent timestamp and correct type) are returned.","descriptionHtml":"<p>Test fetching latest data with type filter from the database, and verify that correct documents (with most recent timestamp and correct type) are returned.</p>\n","status":"failed","statusMessage":"AssertionError: assert 0 == 1\n +  where 0 = len([])","statusTrace":"self = <test_database_analysis_results.TestFetchLatestAnalysisResultsFromDatabase object at 0x7f31823b2d50>\nmock_db = Database(mongomock.MongoClient('localhost', 27017), 'reddit')\n\n    @allure.sub_suite(\"Fetch latest data with type filter\")\n    @allure.description(\"Test fetching latest data with type filter from the database, and verify that correct documents (with most recent timestamp and correct type) are returned.\")\n    def test_fetch_latest_results_with_type_filter(self, mock_db):\n        db = mock_db\n    \n        test_data = [\n            { \"type\": \"topics\", \"label\": \"Topic A\", \"subreddit\": \"example\", \"timestamp\": datetime(2025, 9, 1, 10, 0, tzinfo=timezone.utc) },\n            { \"type\": \"topics\", \"label\": \"Topic B\", \"subreddit\": \"example\", \"timestamp\": datetime(2025, 10, 1, 10, 0, tzinfo=timezone.utc) },\n            { \"type\": \"posts\", \"posts\": [{\"title\": \"Example post\"}], \"subreddit\": \"example\", \"timestamp\": datetime(2025, 11, 1, 10, 0, tzinfo=timezone.utc) },\n        ]\n    \n        collection = \"test_collection\"\n        db[collection].insert_many(test_data)\n    \n        fetched_data = get_latest_data_by_subreddit(collection, subreddit=test_data[0][\"subreddit\"], type=\"topics\")\n        assert isinstance(fetched_data, list)\n>       assert len(fetched_data) == 1 # Check that only one document of type \"topics\" is returned\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE       assert 0 == 1\nE        +  where 0 = len([])\n\ntests/database/test_database_analysis_results.py:59: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"mock_db","time":{"start":1763821889892,"stop":1763821889892,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"monkeypatch","time":{"start":1763821889892,"stop":1763821889892,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[{"name":"mock_db::0","time":{"start":1763821889953,"stop":1763821889953,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"monkeypatch::0","time":{"start":1763821889953,"stop":1763821889953,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"suite","value":"TC-05: Fetch latest analysis results from database"},{"name":"severity","value":"critical"},{"name":"parentSuite","value":"Database tests"},{"name":"subSuite","value":"Fetch latest data with type filter"},{"name":"host","value":"runnervmg1sw1"},{"name":"thread","value":"2526-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.database.test_database_analysis_results"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"critical","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"a28b4b79f542b6d.json","parameterValues":[]}