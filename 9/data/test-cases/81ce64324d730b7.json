{"uid":"81ce64324d730b7","name":"test_calculate_post_numbers_for_existing_subreddit","fullName":"tests.database.test_database_analysis_results.TestCalculatePostNumberStatistics#test_calculate_post_numbers_for_existing_subreddit","historyId":"efa1213355e04f0c78c6de1ea5246c90","time":{"start":1763821889959,"stop":1763821889960,"duration":1},"description":"Test calculating post numbers for existing subreddit, and verify that the correct post count statistics are returned. Expects today's statistics to be included.","descriptionHtml":"<p>Test calculating post numbers for existing subreddit, and verify that the correct post count statistics are returned. Expects today's statistics to be included.</p>\n","status":"failed","statusMessage":"AssertionError: assert False","statusTrace":"self = <test_database_analysis_results.TestCalculatePostNumberStatistics object at 0x7f31823b39e0>\nmock_db = Database(mongomock.MongoClient('localhost', 27017), 'reddit')\n\n    @allure.sub_suite(\"Calculate post numbers for existing subreddit\")\n    @allure.description(\"Test calculating post numbers for existing subreddit, and verify that the correct post count statistics are returned. Expects today's statistics to be included.\")\n    def test_calculate_post_numbers_for_existing_subreddit(self, mock_db):\n        db = mock_db\n    \n        # Ensure test data includes today's date\n        current_date = datetime.now(timezone.utc)\n        test_data =[\n            { \"subreddit\": \"example\", \"num_posts\": 5, \"timestamp\": current_date },\n            { \"subreddit\": \"example\", \"num_posts\": 10, \"timestamp\": (current_date - timedelta(days=1)) },\n            { \"subreddit\": \"example\", \"num_posts\": 15, \"timestamp\": (current_date - timedelta(days=2)) },\n        ]\n    \n        # Tested function uses hardcoded collection name \"posts\"\n        db[\"posts\"].insert_many(test_data)\n    \n        # High number_of_days to include all test data\n        number_of_days = 10\n        post_stats = get_post_numbers_by_timeperiod(subreddit=\"example\", number_of_days=number_of_days)\n        assert isinstance(post_stats, list)\n        results = post_stats[0]\n    \n        current_date_str = current_date.strftime(\"%Y-%m-%d\")\n    \n        current_date_found = False\n        for stat in results[\"daily\"]:\n            if stat[\"day\"] == current_date_str:\n                current_date_found = True\n                break\n    \n>       assert current_date_found # Verify that today's statistics are included\n        ^^^^^^^^^^^^^^^^^^^^^^^^^\nE       assert False\n\ntests/database/test_database_analysis_results.py:142: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"mock_db","time":{"start":1763821889959,"stop":1763821889959,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"monkeypatch","time":{"start":1763821889959,"stop":1763821889959,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[{"name":"mock_db::0","time":{"start":1763821889966,"stop":1763821889966,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"monkeypatch::0","time":{"start":1763821889966,"stop":1763821889966,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"severity","value":"normal"},{"name":"suite","value":"TC-06: Calculate post number statistics from analysis results"},{"name":"parentSuite","value":"Database tests"},{"name":"subSuite","value":"Calculate post numbers for existing subreddit"},{"name":"host","value":"runnervmg1sw1"},{"name":"thread","value":"2526-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.database.test_database_analysis_results"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"81ce64324d730b7.json","parameterValues":[]}